import logging
logging.basicConfig(level=logging.INFO)
import random
import asyncio
from aiogram import Bot, Dispatcher, types
from aiogram.contrib.fsm_storage.memory import MemoryStorage
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup
from aiogram.utils import executor
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton
from aiogram.dispatcher import filters
from aiogram.dispatcher import FSMContext
from aiogram.contrib.fsm_storage.memory import MemoryStorage
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton

API_TOKEN = '7461387126:AAEoNz6baXkY1_irLtS0R8-4XrxtLKtwzRM'

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞
bot = Bot(token=API_TOKEN)
storage = MemoryStorage()
dp = Dispatcher(bot, storage=storage)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π
class Form(StatesGroup):
    menu = State()
    confirmation = State()
    found_animal_description = State()
    found_animal_location = State()
    found_animal_type = State()
    found_animal_condition = State()
    found_animal_behavior = State()
    found_animal_reaction = State()
    found_animal_location = State()
    found_animal_type = State()
    found_animal_condition = State()
    found_animal_wild_domestic = State()
    found_animal_photo = State()
    animal_type_selection = State()  
    user_name = State()
    user_phone = State()
    user_city = State()
    volunteer_name = State()
    volunteer_phone = State()
    volunteer_city = State()
    volunteer_experience = State()
    volunteer_help_types = State()
    confirmation = State()
    learn_more = State()
    confirmation = State()
    choose_field = State()
    description = State()
    location = State()
    animal_type = State()
    condition = State()
    behavior = State()
    reaction = State()
    choose_field = State()
    photo = State()
    waiting_for_application = State()
    waiting_for_status_update = State()
    wild_domestic = State()

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –º–µ–Ω—é "–ù–∞–π—Ç–∏ –ø–æ–º–æ—â—å"
def create_main_menu():
    help_button_1 = KeyboardButton("–Ø –Ω–∞—à–µ–ª(–∞) –∂–∏–≤–æ—Ç–Ω–æ–µ")
    help_button_2 = KeyboardButton("–Ø —Ö–æ—á—É —Å—Ç–∞—Ç—å –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–º")
    help_button_3 = KeyboardButton("–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è")
    

    main_menu = ReplyKeyboardMarkup(resize_keyboard=True).add(help_button_1, help_button_2, help_button_3).add(KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é"))
    
    return main_menu

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
@dp.message_handler(lambda message: message.text == "–ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è")
async def handle_help_button_3(message: types.Message):
    info_message = (
        "–ú—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —Å –¥—Ä—É–≥–∏–º–∏ –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏–º–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º–∏, "
        "–∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç –±–æ–ª—å—à–æ–π –æ–ø—ã—Ç –≤ –ø–æ–º–æ—â–∏ –∂–∏–≤–æ—Ç–Ω—ã–º. –≠—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —Å–º–æ–≥—É—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤–∞—Å "
        "–ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –ø–µ—Ä–µ–¥–µ—Ä–∂–∫–∏ –∏ —É—Ö–æ–¥–∞ –∑–∞ –∂–∏–≤–æ—Ç–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã—Ö –≤—ã —Ä–µ—à–∏–ª–∏ –≤–∑—è—Ç—å.\n\n"
        "–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–æ–º, –∫–∞–∫ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö, –≤—ã –º–æ–∂–µ—Ç–µ "
        "–æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –Ω–∞—à–∏–º –ø–∞—Ä—Ç–Ω—ë—Ä–∞–º. –ë–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –ø–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Å—ã–ª–∫–µ:\n"
        "https://rayfund.ru/about/faq/"
    )
    await message.answer(info_message)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É "–ú–µ–Ω—é"
@dp.message_handler(lambda message: message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é")
async def reset_to_start(message: types.Message):
    await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é















# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
async def send_welcome_message(message: types.Message):
    welcome_text = (
        "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –±–æ—Ç –ø–æ–º–æ—â–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–µ–∑–¥–æ–º–Ω—ã—Ö –∂–∏–≤–æ—Ç–Ω—ã—Ö. "
        "–ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –∏–ª–∏ –≤–∏–¥–µ–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –±–µ–∑ –≤–ª–∞–¥–µ–ª—å—Ü–∞, —è –ø–æ–º–æ–≥—É –≤–∞–º —Å–æ–æ–±—â–∏—Ç—å –æ–± —ç—Ç–æ–º."
    )
    await message.answer(welcome_text, reply_markup=create_main_menu())
    logging.info("–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start
@dp.message_handler(commands=['start'])
async def start_command(message: types.Message, state: FSMContext):
    logging.info("–ö–æ–º–∞–Ω–¥–∞ /start –ø–æ–ª—É—á–µ–Ω–∞")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await state.finish()  # –°–±—Ä–æ—Å –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
    logging.info("–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–±—Ä–æ—à–µ–Ω–æ")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–±—Ä–æ—Å–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    await send_welcome_message(message)

@dp.message_handler(commands=['check_state'])
async def check_state(message: types.Message, state: FSMContext):
    current_state = await state.get_state()
    await message.answer(f"–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: {current_state if current_state else '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è'}")    

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é"
@dp.message_handler(lambda message: message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é")
async def return_to_menu(message: types.Message, state: FSMContext):
    logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await state.finish()  # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    await send_welcome_message(message)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –º–µ–Ω—é
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å:", reply_markup=None)
    


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—ã–±–æ—Ä–∞ "–Ø –Ω–∞—à–µ–ª(–∞) –∂–∏–≤–æ—Ç–Ω–æ–µ"
@dp.message_handler(lambda message: message.text == "–Ø –Ω–∞—à–µ–ª(–∞) –∂–∏–≤–æ—Ç–Ω–æ–µ", state='*')
async def found_animal(message: types.Message, state: FSMContext):
    logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª '–Ø –Ω–∞—à–µ–ª(–∞) –∂–∏–≤–æ—Ç–Ω–æ–µ'")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await Form.found_animal_description.set()
    await message.answer(
    """–û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –∂–∏–≤–æ—Ç–Ω—ã–º.

–£–∫–∞–∂–∏—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:

- –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ –≤–∏–¥–∏–º—ã–µ —Ç—Ä–∞–≤–º—ã (–ø–æ—Ä–µ–∑—ã, —Å—Å–∞–¥–∏–Ω—ã) –∏–ª–∏ –¥—Ä—É–≥–∏–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ, —Ö—Ä–æ–º–æ—Ç–∞, –∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ, –∫–∞—à–µ–ª—å, –∏—Å—Ç–æ—â–µ–Ω–∏–µ)?
  
- –ó–∞–º–µ—á–∞–µ—Ç–µ –ª–∏ –≤—ã –∫–∞–∫–∏–µ-–ª–∏–±–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∂–∏–≤–æ—Ç–Ω–æ–µ –Ω–µ –º–æ–∂–µ—Ç —Ö–æ–¥–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–¥–≤–∏–≥–∞–µ—Ç—Å—è —Å —Ç—Ä—É–¥–æ–º)?

–≠—Ç–∏ –¥–µ—Ç–∞–ª–∏ –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é –∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –ø–æ–º–æ—â—å.
""",
    parse_mode='Markdown', reply_markup=types.ReplyKeyboardRemove()
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã
@dp.message_handler(state=Form.found_animal_description)
async def found_animal_description_received(message: types.Message, state: FSMContext):
    logging.info("–ü–æ–ª—É—á–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã: %s", message.text)  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await state.update_data(description=message.text)
    await Form.found_animal_location.set()

# –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
    location_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    location_button = KeyboardButton("–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é", request_location=True)
    location_keyboard.add(location_button)
    location_keyboard.add(KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é"))  # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
    

    await message.answer(
    """–£–∫–∞–∂–∏—Ç–µ —Ç–æ—á–Ω—ã–π –∞–¥—Ä–µ—Å, –≥–¥–µ –Ω–∞—à–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ.

–ï—Å–ª–∏ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ —Ç–æ—á–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–≤–æ—é –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é. 
–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –Ω–∞—à–∏–º –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞–º –±—ã—Å—Ç—Ä–æ –∏ —Ç–æ—á–Ω–æ –¥–æ–±—Ä–∞—Ç—å—Å—è –¥–æ –º–µ—Å—Ç–∞.""",
    reply_markup=location_keyboard
)

@dp.message_handler(lambda message: message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é", state=Form.found_animal_location)
async def return_to_menu_from_location(message: types.Message, state: FSMContext):
    logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é –∏–∑ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await state.finish()  # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å:", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é




@dp.message_handler(state=Form.found_animal_location)
async def found_animal_location_received(message: types.Message, state: FSMContext):
    if message.location:
        await state.update_data(location=f"{message.location.latitude}, {message.location.longitude}")
    else:
        await state.update_data(location=message.text)

    await Form.found_animal_type.set()
    
   # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
    animal_type_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    button_dog = KeyboardButton("–°–æ–±–∞–∫–∞")
    button_cat = KeyboardButton("–ö–æ—à–∫–∞")
    button_other = KeyboardButton("–î—Ä—É–≥–æ–µ")
    animal_type_keyboard.add(button_dog, button_cat, button_other)
    animal_type_keyboard.add(KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é"))  # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é

    await message.answer(
    """–°–ø–∞—Å–∏–±–æ! 

–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—á–Ω—è, –∫–∞–∫–æ–µ –∏–º–µ–Ω–Ω–æ –∂–∏–≤–æ—Ç–Ω–æ–µ –≤—ã –Ω–∞—à–ª–∏. 

–ï—Å–ª–∏ –∂–∏–≤–æ—Ç–Ω–æ–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ –≤ —Å–ø–∏—Å–∫–µ, –Ω–∞–∂–º–∏—Ç–µ '–î—Ä—É–≥–æ–µ' –∏ –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ. 

–≠—Ç–æ –ø–æ–º–æ–∂–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ —É—Å–ª–æ–≤–∏—è –¥–ª—è –µ–≥–æ —Å–ø–∞—Å–µ–Ω–∏—è.
""",
    reply_markup=animal_type_keyboard
)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é" –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
@dp.message_handler(lambda message: message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é", state=Form.found_animal_type)
async def return_to_menu_from_animal_type(message: types.Message, state: FSMContext):
    logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é –∏–∑ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    await state.finish()  # –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ, –∫–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å:", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é


@dp.message_handler(state=Form.found_animal_type)
async def found_animal_type_received(message: types.Message, state: FSMContext):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ç–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
    if message.text in ["–°–æ–±–∞–∫–∞", "–ö–æ—à–∫–∞"]:
        await state.update_data(animal_type=message.text)
        await Form.found_animal_condition.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
        await ask_animal_condition(message.chat.id)  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
    elif message.text == "–î—Ä—É–≥–æ–µ":
        await message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ, –∫–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ:", reply_markup=None)
        return  # –û—Å—Ç–∞–µ–º—Å—è –≤ —Ç–æ–º –∂–µ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
    else:
        # –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–µ–ª —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ, —Å–æ—Ö—Ä–∞–Ω—è–µ–º —ç—Ç–æ –∫–∞–∫ —Ç–∏–ø –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
        await state.update_data(animal_type=message.text)
        await Form.found_animal_condition.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
        await ask_animal_condition(message.chat.id)  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ


async def ask_animal_condition(chat_id):
    condition_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    condition_options = [
        KeyboardButton("–ò—Å–ø—É–≥–∞–Ω–Ω–æ–µ"),
        KeyboardButton("–ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ"),
        KeyboardButton("–°–ø–æ–∫–æ–π–Ω–æ–µ"),
        KeyboardButton("–î—Ä—É–≥–æ–µ"),
        KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é")  # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤–≤–µ—Å—Ç–∏ —Å–≤–æ–π –æ—Ç–≤–µ—Ç
    ]
    condition_keyboard.add(*condition_options)

    await bot.send_message(chat_id, "–ö–∞–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ?", reply_markup=condition_keyboard)
    await Form.found_animal_condition.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è "–°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ"
@dp.message_handler(state=Form.found_animal_condition)
async def found_animal_condition_received(message: types.Message, state: FSMContext):
    if message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é":
        await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=create_main_menu())  # –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –º–µ–Ω—é
        await state.finish()  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        return

    await state.update_data(condition=message.text)
    await ask_animal_behavior(message.chat.id)

async def ask_animal_behavior(chat_id):
    behavior_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    behavior_options = [
        KeyboardButton("–ü—Ä—è—á–µ—Ç—Å—è"),
        KeyboardButton("–†—ã—á–∏—Ç"),
        KeyboardButton("–ü–æ–¥—Ö–æ–¥–∏—Ç"),
        KeyboardButton("–£–±–µ–≥–∞–µ—Ç"),
        KeyboardButton("–î—Ä—É–≥–æ–µ"),
        KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é")  
    ]
    behavior_keyboard.add(*behavior_options)

    await bot.send_message(chat_id, "–ö–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–æ—è–≤–ª—è–µ—Ç –∂–∏–≤–æ—Ç–Ω–æ–µ –≤ –≤–∞—à–µ–π –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–∏?", reply_markup=behavior_keyboard)
    await Form.found_animal_behavior.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è "–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ"
@dp.message_handler(state=Form.found_animal_behavior)
async def found_animal_behavior_received(message: types.Message, state: FSMContext):
    if message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é":
        logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è '–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ'")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        await state.finish()  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é
        return

    await state.update_data(behavior=message.text)
    await ask_animal_reaction(message.chat.id)

async def ask_animal_reaction(chat_id):
    reaction_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    reaction_options = [
        KeyboardButton("–î–∞"),
        KeyboardButton("–ù–µ—Ç"),
        KeyboardButton("–î—Ä—É–≥–æ–µ"),
        KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é")  # –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é  
    ]
    reaction_keyboard.add(*reaction_options)

    await bot.send_message(chat_id, "–ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ –∫–∞–∫–∏–µ-–ª–∏–±–æ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –≤–∞—à–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–µ—Ç –ª–∏ –æ–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–∞—à–∏ –∫–æ–º–∞–Ω–¥—ã –∏–ª–∏ –¥–≤–∏–∂–µ–Ω–∏–µ)?", reply_markup=reaction_keyboard)
    await Form.found_animal_reaction.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è "–†–µ–∞–∫—Ü–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ"
@dp.message_handler(state=Form.found_animal_reaction)
async def found_animal_reaction_received(message: types.Message, state: FSMContext):
    if message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é":
        logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è '–†–µ–∞–∫—Ü–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ'")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        await state.finish()  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é
        return

    await state.update_data(reaction=message.text)
    await ask_animal_type_selection(message.chat.id)

async def ask_animal_type_selection(chat_id):
    # –°–æ–∑–¥–∞–µ–º –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–æ–º–∞—à–Ω–µ–≥–æ –∏–ª–∏ –¥–∏–∫–æ–≥–æ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ
    wild_domestic_keyboard = ReplyKeyboardMarkup(resize_keyboard=True)
    button_domestic = KeyboardButton("–î–æ–º–∞—à–Ω–µ–µ")
    button_wild = KeyboardButton("–î–∏–∫–æ–µ")
    wild_domestic_keyboard.add(button_domestic, button_wild, KeyboardButton("–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é"))  # –ö–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é
    
    await bot.send_message(chat_id, "–î–æ–º–∞—à–Ω–µ–µ –∏–ª–∏ –¥–∏–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ?", reply_markup=wild_domestic_keyboard)
    await Form.animal_type_selection.set()  # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é
@dp.message_handler(state=Form.animal_type_selection)
async def found_animal_wild_domestic_received(message: types.Message, state: FSMContext):
    if message.text == "–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é":
        logging.info("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–µ—Ä–Ω—É–ª—Å—è –≤ –º–µ–Ω—é –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è '–í—ã–±–æ—Ä —Ç–∏–ø–∞ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ'")  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        await state.finish()  # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        await message.answer("–í—ã –≤–µ—Ä–Ω—É–ª–∏—Å—å –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é.", reply_markup=create_main_menu())  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –º–µ–Ω—é
        return

    logging.info(f"Received wild/domestic type: {message.text}")  # –õ–æ–≥–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–∏–ø
    await state.update_data(wild_domestic=message.text)
    await Form.found_animal_photo.set()
    await message.answer("–ï—Å—Ç—å –ª–∏ —É –≤–∞—Å —Ñ–æ—Ç–æ? (–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ)", reply_markup=types.ReplyKeyboardRemove())

@dp.message_handler(content_types=['photo'], state=Form.found_animal_photo)
async def found_animal_photo_received(message: types.Message, state: FSMContext):
    # –ü–æ–ª—É—á–∞–µ–º file_id —Ñ–æ—Ç–æ
    photo_file_id = message.photo[-1].file_id
    await state.update_data(photo=photo_file_id)  # –°–æ—Ö—Ä–∞–Ω—è–µ–º file_id
    await message.answer("‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ. –£–∫–∞–∂–∏—Ç–µ –í–∞—à–µ –∏–º—è:")
    await Form.user_name.set()

@dp.message_handler(state=Form.user_name)
async def user_name_received(message: types.Message, state: FSMContext):
    await state.update_data(user_name=message.text)
    await Form.user_phone.set()
    await message.answer("–£–∫–∞–∂–∏—Ç–µ –í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω:")

@dp.message_handler(state=Form.user_phone)
async def user_phone_received(message: types.Message, state: FSMContext):
    await state.update_data(user_phone=message.text)
    
    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º —Å—Ä–∞–∑—É –∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—é, –±–µ–∑ –≤–≤–æ–¥–∞ –≥–æ—Ä–æ–¥–∞
    await Form.confirmation.set()
    
    user_data = await state.get_data()
    
    # –ü–æ–ª—É—á–∞–µ–º file_id —Ñ–æ—Ç–æ
    photo_file_id = user_data['photo']
    
    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ç–æ –æ–±—Ä–∞—Ç–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    await message.answer_photo(photo_file_id, caption="–í–æ—Ç –≤–∞—à–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–µ —Ñ–æ—Ç–æ:")
    
    confirmation_text = (
        "–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:\n"
    f"- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã: {user_data.get('description', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è: {user_data.get('location', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {user_data.get('animal_type', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {user_data.get('condition', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {user_data.get('behavior', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ: {user_data.get('reaction', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –î–æ–º–∞—à–Ω–µ–µ/–¥–∏–∫–æ–µ: {user_data.get('wild_domestic', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –°—Ç–∞—Ç—É—Å —Ñ–æ—Ç–æ: ‚úÖ –§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ\n"
    f"- –í–∞—à–µ –∏–º—è: {user_data.get('user_name', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    f"- –í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω: {user_data.get('user_phone', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
    "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å?"
    )

# –°–æ–∑–¥–∞–µ–º inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –∫–Ω–æ–ø–∫–∞–º–∏ "–î–∞" –∏ "–ù–µ—Ç"
    inline_kb = InlineKeyboardMarkup()
    inline_kb.add(InlineKeyboardButton("–î–∞", callback_data='confirm_yes'))
    inline_kb.add(InlineKeyboardButton("–ù–µ—Ç", callback_data='confirm_no'))
    
    await message.answer(confirmation_text, reply_markup=inline_kb)  # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π

@dp.callback_query_handler(lambda c: c.data == 'confirm_yes', state=Form.confirmation)
async def send_info(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏
    user_data = await state.get_data()
    user_name = user_data['user_name']
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞—è–≤–∫–∏
    request_id = random.randint(1000, 9999)  # –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã

    confirmation_message = (
        f"üéâ –°–ø–∞—Å–∏–±–æ, {user_name}! –í–∞—à–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ —Ü–µ–Ω—Ç—Ä –ø–æ–º–æ—â–∏ –∂–∏–≤–æ—Ç–Ω—ã–º.\n"
        f"–í–∞—à ID –∑–∞—è–≤–∫–∏: **{request_id}**.\n"
        f"–°—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏: **–£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞**.\n\n"
        "üîç –ß—Ç–æ –±—É–¥–µ—Ç —Å –∑–∞—è–≤–∫–æ–π –¥–∞–ª—å—à–µ:\n"
        "1. –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –Ω–∞—à–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞.\n"
        "2. –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ.\n"
        "3. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö.\n\n"
        "üí¨ –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è!\n"
        "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –∑–∞–±–æ—Ç—É –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö! üêæ"
    )

    await callback_query.message.answer(confirmation_message, parse_mode='Markdown')
    await asyncio.sleep(5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 5 —Å–µ–∫—É–Ω–¥, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
     # –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∂–∏–≤–æ—Ç–Ω–æ–º
    animal_info = {
    'clinic_name': '–í–µ—Ç–∫–ª–∏–Ω–∏–∫–∞ "–ó–∞–±–æ—Ç–∞"',
    'clinic_phone': '+7 (123) 456-78-90',
    'health_status': '–°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ'
}

    await send_status_updates(callback_query.from_user.id, user_name, request_id, animal_info)
    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏
    await state.finish()

async def send_status_updates(user_id, user_name, request_id, animal_info):
    statuses = [
         f"üéâ –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {user_name}!\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å–ø–∞—Å–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ —Å ID {request_id} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏!\n"
        "üîç –ú—ã —É–∂–µ –Ω–∞—á–∞–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–∞—à—É –∑–∞—è–≤–∫—É.",

        f"\nüëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {user_name}!\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ —Å ID {request_id} –ø—Ä–∏–Ω—è—Ç–∞ –≤ —Ä–∞–±–æ—Ç—É.\n"
        "üîß –ú—ã –∏–∑—É—á–∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º –≤–∞–º–∏ –∂–∏–≤–æ—Ç–Ω–æ–º –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –≤–∞—à–µ–π –∑–∞—è–≤–∫–æ–π.",

        f"\nüîç –£–≤–∞–∂–∞–µ–º—ã–π(–∞—è) {user_name},\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ —Å ID {request_id} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏.\n"
        "üë©‚Äç‚öïÔ∏è –ú—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –≥–æ—Ç–æ–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å–ø–∞—Å–µ–Ω–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ.",

        f"\nüöÄ –û—Ç–ª–∏—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏, {user_name}!\n\n"
        f"üìÑ –ú—ã –Ω–∞—à–ª–∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞, –≥–æ—Ç–æ–≤–æ–≥–æ –ø–æ–º–æ—á—å —Å–æ —Å–ø–∞—Å–µ–Ω–∏–µ–º –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∂–∏–≤–æ—Ç–Ω–æ–≥–æ!\n"
        "ü§ù –í–æ–ª–æ–Ω—Ç–µ—Ä –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –¥–ª—è –æ–∫–∞–∑–∞–Ω–∏—è –ø–æ–º–æ—â–∏.",

        f"\nüè• –ñ–∏–≤–æ—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –≤–µ—Ç–∫–ª–∏–Ω–∏–∫—É!\n\n"
        f"üìÑ –ú—ã –Ω–∞–∑–Ω–∞—á–∏–ª–∏ –æ—Å–º–æ—Ç—Ä –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ç–∫–ª–∏–Ω–∏–∫–µ: {animal_info['clinic_name']}.\n"
        f"üìû –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–Ω–∏–∫–∏: {animal_info['clinic_phone']}.",

        f"\nüîî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:\n\n"
        f"üìÑ –ñ–∏–≤–æ—Ç–Ω–æ–µ –±—ã–ª–æ –æ—Å–º–æ—Ç—Ä–µ–Ω–æ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–æ–º. –°–æ—Å—Ç–æ—è–Ω–∏–µ: {animal_info['health_status']}.\n"
        "üí¨ –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º.",

        f"\nüéä –° —Ä–∞–¥–æ—Å—Ç—å—é —Å–æ–æ–±—â–∞–µ–º, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å —Å–ø–∞—Å–µ–Ω–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω!\n\n"
        f"üìÑ –ñ–∏–≤–æ—Ç–Ω–æ–µ –≥–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±—Ä–∞–Ω–æ –∏–∑ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∏–Ω–∏–∫–∏. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –≤–µ—Ç–∫–ª–∏–Ω–∏–∫–æ–π –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É: {animal_info['clinic_phone']}.\n"
        "üí¨ –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –í–∞—Å –∑–∞ –≤–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –∑–∞–±–æ—Ç—É –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö!",

        f"\nüìù –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à—É –ø–æ–º–æ—â—å!\n\n"
        "ü§î –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–∞–π—Ç–µ –Ω–∞–º –∑–Ω–∞—Ç—å, –∫–∞–∫ –ø—Ä–æ—à–µ–ª –ø—Ä–æ—Ü–µ—Å—Å –∏ –∫–∞–∫ –º—ã –º–æ–∂–µ–º —É–ª—É—á—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –í–∞—à–µ –º–Ω–µ–Ω–∏–µ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è –Ω–∞—Å!"
    ]
    
    for status in statuses:
        await bot.send_message(user_id, status)
        await asyncio.sleep(5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2 —Å–µ–∫—É–Ω–¥—ã)


@dp.callback_query_handler(lambda c: c.data == 'confirm_no', state=Form.confirmation)
async def cancel_info(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏
    

    # –°–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–∞–∫—É—é —á–∞—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–Ω —Ö–æ—á–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å
    choice_kb = InlineKeyboardMarkup()
    choice_kb.add(InlineKeyboardButton("–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã", callback_data='edit_description'))
    choice_kb.add(InlineKeyboardButton("–ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è", callback_data='edit_location'))
    choice_kb.add(InlineKeyboardButton("–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_animal_type'))
    choice_kb.add(InlineKeyboardButton("–°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_condition'))
    choice_kb.add(InlineKeyboardButton("–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_behavior'))
    choice_kb.add(InlineKeyboardButton("–†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ", callback_data='edit_reaction'))
    choice_kb.add(InlineKeyboardButton("–î–æ–º–∞—à–Ω–µ–µ/–¥–∏–∫–æ–µ", callback_data='edit_wild_domestic'))
    choice_kb.add(InlineKeyboardButton("–í–∞—à–µ –∏–º—è", callback_data='edit_user_name'))
    choice_kb.add(InlineKeyboardButton("–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω", callback_data='edit_user_phone'))
    choice_kb.add(InlineKeyboardButton("–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ", callback_data='edit_photo'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–æ—Ç–æ
    choice_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done'))
    await bot.send_message(callback_query.from_user.id, "–ö–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å?", reply_markup=choice_kb)
    await Form.choose_field.set()  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è

@dp.callback_query_handler(lambda c: c.data.startswith('edit_'), state=Form.choose_field)
async def edit_field(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    print("edit_field: –û–±—Ä–∞–±–æ—Ç–∞–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—è.")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ


    field_map = {
        'edit_description': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:',
        'edit_location': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –º–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è:',
        'edit_animal_type': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –≤–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:',
        'edit_condition': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:',
        'edit_behavior': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ:',
        'edit_reaction': '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é —Ä–µ–∞–∫—Ü–∏—é –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ:',
        'edit_wild_domestic': '–í–≤–µ–¥–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –¥–æ–º–∞—à–Ω–µ–µ –∏–ª–∏ –¥–∏–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ:',
        'edit_photo': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ:',
        'edit_user_name': '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –Ω–æ–≤–æ–µ –∏–º—è:',
        'edit_user_phone': '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω:',
    }
    
    field_to_edit = callback_query.data
    prompt = field_map.get(field_to_edit, "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:")
    
    print(f"edit_field: –í—ã–±—Ä–∞–Ω–Ω–æ–µ –ø–æ–ª–µ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: {field_to_edit}")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await callback_query.message.answer(prompt)
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—è
    if field_to_edit == 'edit_description':
        await Form.description.set()
    elif field_to_edit == 'edit_location':
        await Form.location.set()
    elif field_to_edit == 'edit_animal_type':
        await Form.animal_type.set()
    elif field_to_edit == 'edit_condition':
        await Form.condition.set()
    elif field_to_edit == 'edit_behavior':
        await Form.behavior.set()
    elif field_to_edit == 'edit_reaction':
        await Form.reaction.set()
    elif field_to_edit == 'edit_wild_domestic':
        await Form.wild_domestic.set()
    elif field_to_edit == 'edit_photo':
        await Form.photo.set()
    # –ù–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –ø–æ–∫–∞ –∏–º—è –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
    elif field_to_edit == 'edit_user_name':
        await Form.user_name.set()
        print("edit_field: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏.") # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    elif field_to_edit == 'edit_user_phone':
        await Form.user_phone.set()  
        print("edit_field: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.") # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ


@dp.message_handler(state=Form.user_name)
async def process_user_name(message: types.Message, state: FSMContext):
    print("process_user_name: –ü–æ–ª—É—á–µ–Ω–æ –Ω–æ–≤–æ–µ –∏–º—è.")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    async with state.proxy() as data:
        data['user_name'] = message.text  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–µ –∏–º—è
    await message.reply("–í–∞—à–µ –∏–º—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ. –ù–∞–∂–º–∏—Ç–µ '–ì–æ—Ç–æ–≤–æ' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–ù–µ—Ç' –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è.")
    
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    confirmation_kb = InlineKeyboardMarkup()
    confirmation_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done_name'))
    confirmation_kb.add(InlineKeyboardButton("–ù–µ—Ç", callback_data='confirm_no_name'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏

    await message.answer("–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à–µ –∏–º—è:", reply_markup=confirmation_kb)

@dp.callback_query_handler(lambda c: c.data == 'confirm_done_name', state=Form.user_name)
async def confirm_user_name(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    print("confirm_user_name: –ò–º—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ.")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await callback_query.message.answer("–ò–º—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ.")
    
    await Form.user_phone.set()
    await callback_query.message.answer("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω:")  # –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –≤–≤–æ–¥ —Ç–µ–ª–µ—Ñ–æ–Ω–∞


@dp.callback_query_handler(lambda c: c.data == 'confirm_no_name', state=Form.user_name)
async def change_user_name(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    print("change_user_name: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ö–æ—á–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –∏–º—è.")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await callback_query.message.answer("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –Ω–æ–≤–æ–µ –∏–º—è:")
    # –û—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ Form.user_name –∞–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∏–º–µ–Ω–∏


@dp.message_handler(state=Form.user_phone)
async def process_user_phone(message: types.Message, state: FSMContext):
    print("process_user_phone: –ü–æ–ª—É—á–µ–Ω –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞.")  # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    async with state.proxy() as data:
        data['user_phone'] = message.text  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
    await message.reply("–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω. –ù–∞–∂–º–∏—Ç–µ '–ì–æ—Ç–æ–≤–æ' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–ù–µ—Ç' –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è.")
    
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    confirmation_kb = InlineKeyboardMarkup()
    confirmation_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done_phone'))
    confirmation_kb.add(InlineKeyboardButton("–ù–µ—Ç", callback_data='confirm_no_phone'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    
    await message.answer("–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω:", reply_markup=confirmation_kb)

@dp.callback_query_handler(lambda c: c.data == 'confirm_done_phone', state=Form.user_phone)
async def confirm_user_phone(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    await callback_query.message.answer("–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω.")
    await offer_update_options(callback_query.from_user.id, state)  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫ –≤—ã–±–æ—Ä—É –ø–æ–ª–µ–π

@dp.callback_query_handler(lambda c: c.data == 'confirm_no_phone', state=Form.user_phone)
async def change_user_phone(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    await callback_query.message.answer("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –Ω–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω:")
    # –û—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ Form.user_phone –∞–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–≤–æ–¥–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
@dp.message_handler(state=Form.description)
async def process_description(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['description'] = message.text
    await message.reply("–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.location)
async def process_location(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['location'] = message.text
    await message.reply("–ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.animal_type)
async def process_animal_type(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['animal_type'] = message.text
    await message.reply("–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.condition)
async def process_condition(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['condition'] = message.text
    await message.reply("–°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.behavior)
async def process_behavior(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['behavior'] = message.text
    await message.reply("–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.reaction)
async def process_reaction(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['reaction'] = message.text
    await message.reply("–†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∞.")
    await offer_update_options(message.chat.id, state)

@dp.message_handler(state=Form.wild_domestic)
async def process_wild_domestic(message: types.Message, state: FSMContext):
    async with state.proxy() as data:
        data['wild_domestic'] = message.text
    await message.reply("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –¥–æ–º–∞—à–Ω–µ–µ –∏–ª–∏ –¥–∏–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∞.")
    await offer_update_options(message.chat.id, state)
@dp.message_handler(content_types=types.ContentType.PHOTO, state=Form.photo)
async def process_photo(message: types.Message, state: FSMContext):
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–æ—Ç–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    async with state.proxy() as data:
        data['photo'] = message.photo[-1].file_id  # –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Å–∞–º–æ–≥–æ –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ
    await message.reply("–ù–æ–≤–æ–µ —Ñ–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ. –ù–∞–∂–º–∏—Ç–µ '–ì–æ—Ç–æ–≤–æ' –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–ª–∏ '–ù–µ—Ç' –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è.")
    
    # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
    confirmation_kb = InlineKeyboardMarkup()
    confirmation_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done'))
    confirmation_kb.add(InlineKeyboardButton("–ù–µ—Ç", callback_data='confirm_no'))
    
    await message.answer("–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à–µ —Ñ–æ—Ç–æ:", reply_markup=confirmation_kb)

@dp.callback_query_handler(lambda c: c.data == 'confirm_done', state=Form.photo)
async def confirm_photo(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    async with state.proxy() as data:
        photo_id = data.get('photo')
        await bot.send_photo(callback_query.from_user.id, photo_id, caption="–°–ø–∞—Å–∏–±–æ, –í–∞—à–µ —Ñ–æ—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ.")

    await offer_update_options(callback_query.from_user.id, state)  # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –≤—ã–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

@dp.callback_query_handler(lambda c: c.data == 'confirm_no', state=Form.photo)
async def change_photo(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()
    await callback_query.message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ:")
    # –û—Å—Ç–∞–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ Form.photo –∞–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ç–æ

async def offer_update_options(chat_id: int, state: FSMContext):
    choice_kb = InlineKeyboardMarkup()
    choice_kb.add(InlineKeyboardButton("–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã", callback_data='edit_description'))
    choice_kb.add(InlineKeyboardButton("–ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è", callback_data='edit_location'))
    choice_kb.add(InlineKeyboardButton("–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_animal_type'))
    choice_kb.add(InlineKeyboardButton("–°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_condition'))
    choice_kb.add(InlineKeyboardButton("–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_behavior'))
    choice_kb.add(InlineKeyboardButton("–†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ", callback_data='edit_reaction'))
    choice_kb.add(InlineKeyboardButton("–î–æ–º–∞—à–Ω–µ–µ/–¥–∏–∫–æ–µ", callback_data='edit_wild_domestic'))
    choice_kb.add(InlineKeyboardButton("–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ", callback_data='edit_photo'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
    choice_kb.add(InlineKeyboardButton("–í–∞—à–µ –∏–º—è", callback_data='edit_user_name'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏
    choice_kb.add(InlineKeyboardButton("–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω", callback_data='edit_user_phone'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    choice_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done'))

    await bot.send_message(chat_id, "–ö–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å?", reply_markup=choice_kb)
    await Form.choose_field.set()  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è

@dp.callback_query_handler(lambda c: c.data == 'confirm_done', state=Form.choose_field)
async def confirm_done(callback_query: types.CallbackQuery, state: FSMContext):
    async with state.proxy() as data:
        confirmation_text = (
            "–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:\n"
            f"- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã: {data.get('description', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è: {data.get('location', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {data.get('animal_type', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {data.get('condition', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ: {data.get('behavior', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ: {data.get('reaction', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –î–æ–º–∞—à–Ω–µ–µ/–¥–∏–∫–æ–µ: {data.get('wild_domestic', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –í–∞—à–µ –∏–º—è: {data.get('user_name', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            f"- –í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω: {data.get('user_phone', '–ù–µ —É–∫–∞–∑–∞–Ω–æ')}\n"
            "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫—É –∑–∞–ø—Ä–æ—Å–∞?"
        )

    inline_kb = InlineKeyboardMarkup()
    inline_kb.add(InlineKeyboardButton("–î–∞", callback_data='confirm_yes'))
    inline_kb.add(InlineKeyboardButton("–ù–µ—Ç", callback_data='confirm_no'))

    await callback_query.message.answer(confirmation_text, reply_markup=inline_kb)

@dp.callback_query_handler(lambda c: c.data == 'confirm_yes', state=Form.choose_field)
async def confirm_submission(callback_query: types.CallbackQuery, state: FSMContext):
    async with state.proxy() as data:
        user_name = data.get('user_name', '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å')  # –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞—è–≤–∫–∏
        request_id = random.randint(1000, 9999)  # –ü—Ä–∏–º–µ—Ä –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã

        confirmation_message = (
            f"üéâ –°–ø–∞—Å–∏–±–æ, {user_name}! –í–∞—à–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ —Ü–µ–Ω—Ç—Ä –ø–æ–º–æ—â–∏ –∂–∏–≤–æ—Ç–Ω—ã–º.\n"
            f"–í–∞—à ID –∑–∞—è–≤–∫–∏: **{request_id}**.\n"
            f"–°—Ç–∞—Ç—É—Å –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏: **–£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞**.\n\n"
            "üîç –ß—Ç–æ –±—É–¥–µ—Ç —Å –∑–∞—è–≤–∫–æ–π –¥–∞–ª—å—à–µ:\n"
            "1. –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –Ω–∞—à–∏–º–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 1 —á–∞—Å–∞.\n"
            "2. –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —Å –≤–∞–º–∏ —Å–≤—è–∂–µ—Ç—Å—è –Ω–∞—à –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ.\n"
            "3. –í—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è –≤–∞—à–µ–π –∑–∞—è–≤–∫–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö.\n\n"
            "üí¨ –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è!\n"
            "–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –∑–∞–±–æ—Ç—É –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö! üêæ"
        )

    await callback_query.message.answer(confirmation_message, parse_mode='Markdown')
    await asyncio.sleep(5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –≤ 5 —Å–µ–∫—É–Ω–¥, –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ
     # –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∂–∏–≤–æ—Ç–Ω–æ–º
    animal_info = {
    'clinic_name': '–í–µ—Ç–∫–ª–∏–Ω–∏–∫–∞ "–ó–∞–±–æ—Ç–∞"',
    'clinic_phone': '+7 (123) 456-78-90',
    'health_status': '–°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ'
}

    await send_status_updates(callback_query.from_user.id, user_name, request_id, animal_info)
    # –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏
    await state.finish()

async def send_status_updates(user_id, user_name, request_id, animal_info):
    statuses = [
         f"üéâ –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {user_name}!\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Å–ø–∞—Å–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ —Å ID {request_id} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏!\n"
        "üîç –ú—ã —É–∂–µ –Ω–∞—á–∞–ª–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤–∞—à—É –∑–∞—è–≤–∫—É.",

        f"\nüëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, {user_name}!\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ —Å ID {request_id} –ø—Ä–∏–Ω—è—Ç–∞ –≤ —Ä–∞–±–æ—Ç—É.\n"
        "üîß –ú—ã –∏–∑—É—á–∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –Ω–∞–π–¥–µ–Ω–Ω–æ–º –≤–∞–º–∏ –∂–∏–≤–æ—Ç–Ω–æ–º –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –≤–∞—à–µ–π –∑–∞—è–≤–∫–æ–π.",

        f"\nüîç –£–≤–∞–∂–∞–µ–º—ã–π(–∞—è) {user_name},\n\n"
        f"üìÑ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ —Å ID {request_id} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏.\n"
        "üë©‚Äç‚öïÔ∏è –ú—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ –≥–æ—Ç–æ–≤–∏–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å–ø–∞—Å–µ–Ω–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ.",

        f"\nüöÄ –û—Ç–ª–∏—á–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏, {user_name}!\n\n"
        f"üìÑ –ú—ã –Ω–∞—à–ª–∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞, –≥–æ—Ç–æ–≤–æ–≥–æ –ø–æ–º–æ—á—å —Å–æ —Å–ø–∞—Å–µ–Ω–∏–µ–º –∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π –∂–∏–≤–æ—Ç–Ω–æ–≥–æ!\n"
        "ü§ù –í–æ–ª–æ–Ω—Ç–µ—Ä –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –∞–¥—Ä–µ—Å—É –¥–ª—è –æ–∫–∞–∑–∞–Ω–∏—è –ø–æ–º–æ—â–∏.",

        f"\nüè• –ñ–∏–≤–æ—Ç–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –≤–µ—Ç–∫–ª–∏–Ω–∏–∫—É!\n\n"
        f"üìÑ –ú—ã –Ω–∞–∑–Ω–∞—á–∏–ª–∏ –æ—Å–º–æ—Ç—Ä –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ç–∫–ª–∏–Ω–∏–∫–µ: {animal_info['clinic_name']}.\n"
        f"üìû –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–Ω–∏–∫–∏: {animal_info['clinic_phone']}.",

        f"\nüîî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞:\n\n"
        f"üìÑ –ñ–∏–≤–æ—Ç–Ω–æ–µ –±—ã–ª–æ –æ—Å–º–æ—Ç—Ä–µ–Ω–æ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–æ–º. –°–æ—Å—Ç–æ—è–Ω–∏–µ: {animal_info['health_status']}.\n"
        "üí¨ –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã, –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –Ω–∞–º.",

        f"\nüéä –° —Ä–∞–¥–æ—Å—Ç—å—é —Å–æ–æ–±—â–∞–µ–º, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å —Å–ø–∞—Å–µ–Ω–∏—è –∂–∏–≤–æ—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω!\n\n"
        f"üìÑ –ñ–∏–≤–æ—Ç–Ω–æ–µ –≥–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±—Ä–∞–Ω–æ –∏–∑ –≤–µ—Ç–µ—Ä–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∏–Ω–∏–∫–∏. –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –≤–µ—Ç–∫–ª–∏–Ω–∏–∫–æ–π –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É: {animal_info['clinic_phone']}.\n"
        "üí¨ –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –í–∞—Å –∑–∞ –≤–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ –∏ –∑–∞–±–æ—Ç—É –æ –∂–∏–≤–æ—Ç–Ω—ã—Ö!",

        f"\nüìù –ú—ã —Ü–µ–Ω–∏–º –≤–∞—à—É –ø–æ–º–æ—â—å!\n\n"
        "ü§î –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–∞–π—Ç–µ –Ω–∞–º –∑–Ω–∞—Ç—å, –∫–∞–∫ –ø—Ä–æ—à–µ–ª –ø—Ä–æ—Ü–µ—Å—Å –∏ –∫–∞–∫ –º—ã –º–æ–∂–µ–º —É–ª—É—á—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞. –í–∞—à–µ –º–Ω–µ–Ω–∏–µ –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ –¥–ª—è –Ω–∞—Å!"
    ]
    
    for status in statuses:
        await bot.send_message(user_id, status)
        await asyncio.sleep(5)  # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2 —Å–µ–∫—É–Ω–¥—ã)

@dp.callback_query_handler(lambda c: c.data == 'confirm_no', state=Form.choose_field)
async def cancel_info(callback_query: types.CallbackQuery, state: FSMContext):
    await callback_query.answer()  # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏
    await offer_update_options(callback_query.from_user.id, state)  # –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –≤—ã–±—Ä–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

async def offer_update_options(chat_id: int, state: FSMContext):
    choice_kb = InlineKeyboardMarkup()
    choice_kb.add(InlineKeyboardButton("–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã", callback_data='edit_description'))
    choice_kb.add(InlineKeyboardButton("–ú–µ—Å—Ç–æ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è", callback_data='edit_location'))
    choice_kb.add(InlineKeyboardButton("–í–∏–¥ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_animal_type'))
    choice_kb.add(InlineKeyboardButton("–°–æ—Å—Ç–æ—è–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_condition'))
    choice_kb.add(InlineKeyboardButton("–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω–æ–≥–æ", callback_data='edit_behavior'))
    choice_kb.add(InlineKeyboardButton("–†–µ–∞–∫—Ü–∏—è –Ω–∞ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ", callback_data='edit_reaction'))
    choice_kb.add(InlineKeyboardButton("–î–æ–º–∞—à–Ω–µ–µ/–¥–∏–∫–æ–µ", callback_data='edit_wild_domestic'))
    choice_kb.add(InlineKeyboardButton("–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ", callback_data='edit_photo'))
    choice_kb.add(InlineKeyboardButton("–í–∞—à–µ –∏–º—è", callback_data='edit_user_name'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏
    choice_kb.add(InlineKeyboardButton("–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω", callback_data='edit_user_phone'))  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞  # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ
    choice_kb.add(InlineKeyboardButton("–ì–æ—Ç–æ–≤–æ", callback_data='confirm_done'))

    await bot.send_message(chat_id, "–ö–∞–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å?", reply_markup=choice_kb)
    await Form.choose_field.set()  # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø–æ–ª—è


    
    
















@dp.message_handler(lambda message: message.text == "–Ø —Ö–æ—á—É —Å—Ç–∞—Ç—å –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–º")
async def volunteer_menu(message: types.Message):
    await Form.volunteer_name.set()
    await message.answer("–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ –≤–∞—à—É –∑–∞—è–≤–∫—É, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:\n–£–∫–∞–∂–∏—Ç–µ –í–∞—à–µ –∏–º—è:")

@dp.message_handler(state=Form.volunteer_name)
async def volunteer_name_received(message: types.Message, state: FSMContext):
    # –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –∏–º–µ–Ω–µ–º –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞
    await state.update_data(volunteer_name=message.text)
    
    # –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–≤–µ—Å—Ç–∏ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    await message.answer("–°–ø–∞—Å–∏–±–æ! –¢–µ–ø–µ—Ä—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –≤–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ.")

    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–ª—è –≤–≤–æ–¥–∞ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    await Form.volunteer_phone.set()

@dp.message_handler(state=Form.volunteer_phone)
async def volunteer_phone_received(message: types.Message, state: FSMContext):
    # –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
    phone_number = message.text
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
    await state.update_data(volunteer_phone=phone_number)
    
    # –£–≤–µ–¥–æ–º–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ
    await message.answer("–°–ø–∞—Å–∏–±–æ! –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω.")

    # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –¥–ª—è –≤–≤–æ–¥–∞ –≥–æ—Ä–æ–¥–∞
    await Form.volunteer_city.set()
    await message.answer("–£–∫–∞–∂–∏—Ç–µ –í–∞—à –≥–æ—Ä–æ–¥:")

@dp.message_handler(state=Form.volunteer_city)
async def volunteer_city_received(message: types.Message, state: FSMContext):
    await state.update_data(volunteer_city=message.text)
    await Form.volunteer_experience.set()
    await message.answer("–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏:")

@dp.message_handler(state=Form.volunteer_experience)
async def volunteer_experience_received(message: types.Message, state: FSMContext):
    await state.update_data(volunteer_experience=message.text)
    await Form.volunteer_help_types.set()
    await message.answer("–ö–∞–∫–∏–µ –≤–∏–¥—ã –ø–æ–º–æ—â–∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ–∫–∞–∑—ã–≤–∞—Ç—å? (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ–≤–æ–∑–∫–∞ —Å –º–µ—Å—Ç–∞ –Ω–∞ –º–µ—Å—Ç–æ, –ø–µ—Ä–µ–¥–µ—Ä–∂–∫–∞, –≤—ã–≥—É–ª, –ø–æ–º–æ—â—å —Å –ª–µ—á–µ–Ω–∏–µ–º, –ø–æ–∏—Å–∫ –¥–æ–º–∞ –∏ —Ç.–¥.)")

@dp.message_handler(state=Form.volunteer_help_types)
async def volunteer_help_types_received(message: types.Message, state: FSMContext):
    await state.update_data(volunteer_help_types=message.text)
    
    # –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    user_data = await state.get_data()
    confirmation_text = (
        "–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:\n"
        f"- –í–∞—à–µ –∏–º—è: {user_data['volunteer_name']}\n"
        f"- –í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω: {user_data['volunteer_phone']}\n"
        f"- –í–∞—à –≥–æ—Ä–æ–¥: {user_data['volunteer_city']}\n"
        f"- –û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∂–∏–≤–æ—Ç–Ω—ã–º–∏: {user_data['volunteer_experience']}\n"
        f"- –í–∏–¥—ã –ø–æ–º–æ—â–∏: {user_data['volunteer_help_types']}\n"
        "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å? –î–∞/–ù–µ—Ç"
    )
    
    await message.answer(confirmation_text)
    await Form.confirmation.set()

@dp.message_handler(lambda message: message.text.lower() == '–¥–∞', state=Form.confirmation)
async def send_info(message: types.Message, state: FSMContext):
    await message.answer("–°–ø–∞—Å–∏–±–æ! –í–∞—à–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞. –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏!")
    await state.finish()

@dp.message_handler(lambda message: message.text.lower() == '–Ω–µ—Ç', state=Form.confirmation)
async def change_info(message: types.Message, state: FSMContext):
    await message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.")
    await Form.volunteer_name.set()

# –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±–æ—Ç–µ
@dp.message_handler(lambda message: message.text == "–Ø —Ö–æ—á—É —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –±–æ—Ç–µ")
async def info_menu(message: types.Message):
    await Form.info_menu.set()
    info_text = (
        "–û –ø—Ä–æ–µ–∫—Ç–µ:\n–≠—Ç–æ—Ç –±–æ—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø–æ–º–æ—â–∏ –∂–∏–≤–æ—Ç–Ω—ã–º –∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞–º.\n\n"
        "–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º:\n–í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –≤–∞–º –ø—É–Ω–∫—Ç –º–µ–Ω—é –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º.\n\n"
        "–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã:\n1. –ö–∞–∫ —Å—Ç–∞—Ç—å –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–º?\n2. –ö–∞–∫ –ø–æ–º–æ—á—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ?\n\n"
        "–ö–æ–Ω—Ç–∞–∫—Ç—ã:\n–í—ã –º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –Ω–∞–º–∏ —á–µ—Ä–µ–∑ —Å–æ—Ü—Å–µ—Ç–∏ –∏–ª–∏ –ø–æ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç–µ."
    )
    await message.answer(info_text)

if __name__ == '__main__':
    executor.start_polling(dp, skip_updates=True)
